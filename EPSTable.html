<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableur de Statistiques d'Élèves</title>
    <style>
        table {
            width: 50%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 8px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
        }
    </style>
</head>
<body>
    <textarea id="studentNames" rows="4" cols="50" placeholder="Entrez les noms des élèves, séparés par des virgules..."></textarea>
    <br>
    <button onclick="updateStudentList()">Mettre à jour la liste</button>
    <table id="table">
        <tr>
            <th>Nom</th>
            <th>Buts</th>
            <th>Tirs</th>
            <th>Passes</th>
        </tr>
        <tr>
            <td>Élève 1</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
        <tr>
            <td>Élève 2</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
        <tr>
            <td>Élève 3</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
    </table>
    <button onclick="changeValue('Tirs')">Changer les Tirs</button>
    <button onclick="changeValue('Buts')">Changer les Buts</button>
    <button onclick="changeValue('Passes')">Changer les Passes</button>
    <button onclick="exportToExcel()">Exporter en Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        function updateStudentList() {
            let names = document.getElementById('studentNames').value.split(',');
            let table = document.getElementById('table');

            // Clear existing rows except the header
            while (table.rows.length > 1) {
                table.deleteRow(1);
            }

            // Add new rows
            names.forEach(name => {
                let row = table.insertRow();
                let cell1 = row.insertCell(0);
                let cell2 = row.insertCell(1);
                let cell3 = row.insertCell(2);
                let cell4 = row.insertCell(3);
                cell1.innerText = name.trim();
                cell2.innerText = "0";
                cell3.innerText = "0";
                cell4.innerText = "0";
                cell2.contentEditable = "true";
                cell3.contentEditable = "true";
                cell4.contentEditable = "true";
            });
        }

        function changeValue(stat) {
            let name = prompt("Nom de l'élève :");
            let value = prompt(`Nouveau nombre de ${stat} :`);

            let table = document.getElementById("table");
            for (let i = 1; i < table.rows.length; i++) {
                if (table.rows[i].cells[0].innerText === name) {
                    let index = stat === 'Buts' ? 1 : stat === 'Tirs' ? 2 : 3;
                    table.rows[i].cells[index].innerText = value;
                    break;
                }
            }
        }

        function exportToExcel() {
            let table = document.getElementById("table");
            let wb = XLSX.utils.table_to_book(table, {sheet: "Sheet1"});
            XLSX.writeFile(wb, "statistiques_eleves.xlsx");
        }
    </script>
</body>
</html>
