<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableur de Statistiques d'Élèves</title>
    <style>
        table {
            width: 50%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid black;
            text-align: center;
            padding: 8px;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
        }
    </style>
</head>
<body>
    <input type="file" id="fileInput" accept=".txt" style="margin-bottom: 20px;">
    <table id="table">
        <tr>
            <th>Nom</th>
            <th>Buts</th>
            <th>Tirs</th>
            <th>Passes</th>
        </tr>
        <tr>
            <td>Élève 1</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
        <tr>
            <td>Élève 2</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
        <tr>
            <td>Élève 3</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
            <td contenteditable="true">0</td>
        </tr>
    </table>
    <button onclick="changeValue('Tirs')">Changer les Tirs</button>
    <button onclick="changeValue('Buts')">Changer les Buts</button>
    <button onclick="changeValue('Passes')">Changer les Passes</button>
    <button onclick="exportToExcel()">Exporter en Excel</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        document.getElementById('fileInput').addEventListener('change', loadFile);

        function loadFile(event) {
            const input = event.target;
            if ('files' in input && input.files.length > 0) {
                placeFileContent(input.files[0]);
            }
        }

        function placeFileContent(file) {
            readFileContent(file).then(content => {
                const names = content.split('\n').map(name => name.trim()).filter(name => name !== "");
                updateTable(names);
            }).catch(error => console.log(error));
        }

        function readFileContent(file) {
            const reader = new FileReader();
            return new Promise((resolve, reject) => {
                reader.onload = event => resolve(event.target.result);
                reader.onerror = error => reject(error);
                reader.readAsText(file);
            });
        }

        function updateTable(names) {
            const table = document.getElementById("table");
            while (table.rows.length > 1) {
                table.deleteRow(1);
            }
            names.forEach(name => {
                let row = table.insertRow();
                let cellName = row.insertCell(0);
                let cellButs = row.insertCell(1);
                let cellTirs = row.insertCell(2);
                let cellPasses = row.insertCell(3);
                cellName.innerText = name;
                cellButs.innerText = "0";
                cellTirs.innerText = "0";
                cellPasses.innerText = "0";
                cellButs.contentEditable = "true";
                cellTirs.contentEditable = "true";
                cellPasses.contentEditable = "true";
            });
        }

        function changeValue(stat) {
            let name = prompt("Nom de l'élève :");
            let value = prompt(`Nouveau nombre de ${stat} :`);

            let table = document.getElementById("table");
            for (let i = 1; i < table.rows.length; i++) {
                if (table.rows[i].cells[0].innerText === name) {
                    let index = stat === 'Buts' ? 1 : stat === 'Tirs' ? 2 : 3;
                    table.rows[i].cells[index].innerText = value;
                    break;
                }
            }
        }

        function exportToExcel() {
            let table = document.getElementById("table");
            let wb = XLSX.utils.table_to_book(table, {sheet: "Sheet1"});
            XLSX.writeFile(wb, "statistiques_eleves.xlsx");
        }
    </script>
</body>
</html>
